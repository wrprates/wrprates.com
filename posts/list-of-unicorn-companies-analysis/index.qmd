---
title: "List of Unicorn Companies Analysis"
author: "Wlademir Ribeiro Prates"
date: "2022-07-29"
categories: [Reporting]
---

The full and updated list of Unicorn companies used on this analysis can be found [here](https://www.cbinsights.com/research-unicorn-companies), at the CBInsights website.

## Reading Unicorn companies list

First, we need to load the used packages and read the data. Below I am showing the top 5 unicorn companies, with all the variables from the raw data.

```{r}
#| warning: false
#| message: false

# Loading packages
library(dplyr)
library(echarts4r)
library(lubridate)
library(reactable)
library(readxl)

# Reading the Excel file
unicorn_data <- readxl::read_excel("unicorn_companies.xlsx", skip = 2) |>
  dplyr::arrange(dplyr::desc("Valuation ($B)")) |>
  dplyr::mutate(`Years of existence` = floor((lubridate::interval(`Date Joined`, lubridate::today()) %/% months(1)) / 12))

# Creating an interactive table
reactable::reactable(
  unicorn_data |> dplyr::select(-`Date Joined`),
  columns = list(
    `Select Investors` = colDef(minWidth = 180)
  ),
  style = list(fontSize = "0.70rem"),
  defaultPageSize = 10,
  searchable = TRUE,
  striped = TRUE
)
```

## Treemap

```{r}
tree_data <- unicorn_data |>
  dplyr::arrange(dplyr::desc(`Valuation ($B)`)) |>
  dplyr::select(Industry, name = Company, value = `Valuation ($B)`) |>
  tidyr::nest(children = c("name", "value")) |>
  dplyr::mutate(value = purrr::map_dbl(children, ~ sum(.x$value))) |>
  dplyr::mutate(children = purrr::map(children, ~ filter(., value >= 5))) |>
  dplyr::rename(name = Industry)


tree_data |>
  echarts4r::e_charts() |>
  echarts4r::e_title(text = "Unicorn companies by Industry") |>
  echarts4r::e_theme("auritus") |>
  echarts4r::e_treemap(
    leafDepth = 2,
    breadcrumb = TRUE,
    backgroundColor = "red",
    itemStyle = list(normal = list(
      borderWidth = 0,
      gapWidth = 2,
      backgroundColor = "gray70"
    )),
    name = "Having fun with treemaps",
    upperLabel = list(normal = list(
      show = TRUE,
      height = 30,
      formatter = "{b}",
      color = "black",
      fontSize = 16
    ))
  ) |>
  echarts4r::e_tooltip()

```


## Boxplot by categories

```{r}
boxplot_by_category <- function(data, category, outliers) {
  data |>
    dplyr::group_by(!!rlang::sym(category)) |>
    echarts4r::e_charts() |>
    echarts4r::e_boxplot(serie = `Valuation ($B)`, outliers = outliers) |>
    echarts4r::e_tooltip()
}
```


### By Industry

```{r}
boxplot_by_category(unicorn_data, category = "Industry", outliers = FALSE)
```


### By Country

```{r}
boxplot_by_category(unicorn_data, category = "Country", outliers = FALSE)
```

Para investigar:

- X empresas equivalem a X% de todo o valuation das Unicorns: Gr√°fico de linha com soma cumulativo do valuation 
- Boxplot por grupamentos: country, industry, intervalo de tempo de vida da empresa
